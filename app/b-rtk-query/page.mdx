import { Callout } from "nextra/components"

# 2. RTK query

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ [Redux Toolkit](https://redux-toolkit.js.org) –∏ [React Redux](https://react-redux.js.org):

```bash filename="Terminal"
pnpm add @reduxjs/toolkit react-redux
```

## Client State vs Server State

| **Client State**                                                  | **Server State**                 |
| :---------------------------------------------------------------- | :------------------------------- |
| - Form fields entered by the user                                 | - Results of a database query    |
| - Selected filters on the page                                    |                                  |
| - Dark / light theme                                              |                                  |
| - Local interface data, e.g., current page in pagination          |                                  |
| - Data stored in local storage (LocalStorage, SessionStorage)     |                                  |
| - Temporary state in a React component (useState)                 |                                  |
| - Modal windows                                                   |                                  |
| - Complex forms (wizard)                                          |                                  |
|                                                                   |                                  |
| **Tools for Client State**                                        | **Tools for Server State**       |
| Redux Toolkit (slice) / useState / useReducer / Zustand / Context | RTK Query / TanStack Query / SWR |

–†–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É **Client State** –∏ **Server State** –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Å–ø–æ—Å–æ–±–∞—Ö —Ö—Ä–∞–Ω–µ–Ω–∏—è,
–æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π:

| **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞** | **Client State**                                                                                                                                                                 | **Server State**                                                                                                                   |
| ------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------- |
| **–ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è**   | –ù–∞ —Å—Ç–æ—Ä–æ–Ω–µ –∫–ª–∏–µ–Ω—Ç–∞ (–≤ –±—Ä–∞—É–∑–µ—Ä–µ, –ª–æ–∫–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏).                                                                                                                           | –ù–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞.                                                                                                                |
| **–ü—Ä–∏–º–µ—Ä—ã**        | - –ø–æ–ª—è —Ñ–æ—Ä–º—ã; <br/> - –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã; <br/> - –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–µ–∫—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞); <br/> - `localStorage`, `sessionStorage`; <br/> - `useState` –≤ React. | - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∏–∑ –ë–î; <br/> - —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏; <br/> - –¥–∞–Ω–Ω—ã–µ –æ –∑–∞–∫–∞–∑–∞—Ö; <br/> - —Å–æ—Å—Ç–æ—è–Ω–∏–µ —á–∞—Ç–∞ —á–µ—Ä–µ–∑ `WebSocket`. |
| **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**   | - –±—ã—Å—Ç—Ä–æ—Ç–∞ –¥–æ—Å—Ç—É–ø–∞ –±–µ–∑ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä; <br/> - –∞–≤—Ç–æ–Ω–æ–º–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –≤ –æ—Ñ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º–µ (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏).                                                                             | - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏; <br/> - –≤—ã—Å–æ–∫–∏–π —É—Ä–æ–≤–µ–Ω—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏; <br/> - –ø—Ä–æ—Å—Ç–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –º–µ–∂–¥—É –∫–ª–∏–µ–Ω—Ç–∞–º–∏.        |
| **–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏**     | - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –æ–±—ä—ë–º –¥–∞–Ω–Ω—ã—Ö; <br/> - —Å–ª–æ–∂–Ω–æ—Å—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Å —Å–µ—Ä–≤–µ—Ä–æ–º; <br/> - —É—è–∑–≤–∏–º–æ—Å—Ç—å –∫ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è–º.                                                                      | - –∑–∞–¥–µ—Ä–∂–∫–∏ –∏–∑-–∑–∞ —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤; <br/> - –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è; <br/> - –Ω–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä.                                  |

## RTK query - —Ç–µ–æ—Ä–∏—è

<Callout type={"info"} emoji={"üîó"}>

- [RTK Query Quick Start](https://redux-toolkit.js.org/tutorials/rtk-query);

- [RTK Query Overview](https://redux-toolkit.js.org/rtk-query/overview);

- [RTK Query Basics](https://redux.js.org/tutorials/essentials/part-7-rtk-query-basics);

- [RTK Query Advanced Patterns](https://redux.js.org/tutorials/essentials/part-8-rtk-query-advanced)

</Callout>

`RTK Query` - –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞–º–∏ –∫ `API` –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ `React`-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö
—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º `Redux Toolkit`. `RTK Query` –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª–µ–∑–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª: –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤,
–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–æ–π –¥–∞–Ω–Ω—ã—Ö –∏ –¥—Ä.

–û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è `RTK Query` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è `Redux Slice` (–Ω–∞–±–æ—Ä `Redux-–¥–µ–π—Å—Ç–≤–∏–π` –∏
—Ä–µ–¥—å—é—Å–µ—Ä–æ–≤) –Ω–∞ –æ—Å–Ω–æ–≤–µ `API`-—ç–Ω–¥–ø–æ–∏–Ω—Ç–∞, –∞ –∑–∞—Ç–µ–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ö—É–∫–æ–≤ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö `React`.

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ RTK Query:**

- **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫—ç—à–∏—Ä—É–µ—Ç –æ—Ç–≤–µ—Ç—ã –Ω–∞ –∑–∞–ø—Ä–æ—Å—ã** –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –∏—Ö —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏;
- **–º–æ–∂–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ**, –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –æ—Ç `API`, —á—Ç–æ–±—ã –æ–±–ª–µ–≥—á–∏—Ç—å–∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏;
- **–ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤**: –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è, –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏, —Ç–∏–ø –∑–∞–ø—Ä–æ—Å–∞ –∏ –¥—Ä.;
- **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ª–∞–≤–ª–∏–≤–∞–µ—Ç –æ—à–∏–±–∫–∏**, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –∑–∞–ø—Ä–æ—Å–∞–º–∏, –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —É–¥–æ–±–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã –∏—Ö –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏;
- **—É–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö** –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Å–ø–æ—Å–æ–±—ã –∏—Ö –ø–æ–ª—É—á–µ–Ω–∏—è –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∑ –ª—é–±–æ–π —á–∞—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

`RTK Query` —É–ø—Ä–æ—â–∞–µ—Ç —Ä–∞–±–æ—Ç—É —Å API –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º, –ø–æ–∑–≤–æ–ª—è—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è
–Ω–∞ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∞ –Ω–µ –Ω–∞ –¥–µ—Ç–∞–ª—è—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º.

## Queries

[Queries](https://redux-toolkit.js.org/rtk-query/usage/queries) –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Å —Å–µ—Ä–≤–µ—Ä–∞.

[–ë–∞–∑–æ–≤–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ](https://redux-toolkit.js.org/rtk-query/overview#basic-usage)

- `playlistsApi.ts`

```ts filename="playlistsApi.ts"
// –í–æ –∏–∑–±–µ–∂–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ –∏–º–ø–æ—Ä—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∏–∑ `@reduxjs/toolkit/query/react`
import { createApi, fetchBaseQuery } from "@reduxjs/toolkit/query/react"

// `createApi` - —Ñ—É–Ω–∫—Ü–∏—è –∏–∑ `RTK Query`, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è —Å–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç `API`
// –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ `API` –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
export const playlistsApi = createApi({
  // `reducerPath` - –∏–º—è –∫—É–¥–∞ –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ —ç–∫—à–µ–Ω—ã –¥–ª—è —ç—Ç–æ–≥–æ `API`
  reducerPath: "playlistsApi",
  // `baseQuery` - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è `HTTP-–∫–ª–∏–µ–Ω—Ç–∞`, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
  baseQuery: fetchBaseQuery({
    baseUrl: import.meta.env.VITE_BASE_URL,
    headers: {
      "API-KEY": import.meta.env.VITE_API_KEY,
    },
  }),
  // `endpoints` - –º–µ—Ç–æ–¥, –≤–æ–∑–≤—Ä–∞—â–∞—é—â–∏–π –æ–±—ä–µ–∫—Ç —Å —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞–º–∏ –¥–ª—è `API`, –æ–ø–∏—Å–∞–Ω–Ω—ã–º–∏
  // —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è –ø—Ä–∏ –≤—ã–∑–æ–≤–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –º–µ—Ç–æ–¥–æ–≤ `API`
  // (–Ω–∞–ø—Ä–∏–º–µ—Ä `get`, `post`, `put`, `patch`, `delete`)
  endpoints: (build) => ({
    // –¢–∏–ø–∏–∑–∞—Ü–∏—è –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ (<–≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–π —Ç–∏–ø, —Ç–∏–ø query –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ (`QueryArg`)>)
    // `query` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–æ–∑–¥–∞–µ—Ç –∑–∞–ø—Ä–æ—Å `get` –∏ —É–∫–∞–∑–∞–Ω–∏–µ –º–µ—Ç–æ–¥–∞ –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ
    fetchPlaylists: build.query<PlaylistsResponse, FetchPlaylistsArgs>({
      query: () => {
        return {
          method: "get",
          url: `playlists`,
        }
      },
    }),
  }),
})

// `createApi` —Å–æ–∑–¥–∞–µ—Ç –æ–±—ä–µ–∫—Ç `API`, –∫–æ—Ç–æ—Ä—ã–π —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –≤ –≤–∏–¥–µ —Ö—É–∫–æ–≤,
// –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –≤ —Å–≤–æ–π—Å—Ç–≤–µ `endpoints`
export const { useFetchPlaylistsQuery } = playlistsApi
```

<Callout emoji={'üîó'} type={'info'}>
  - `VITE_BASE_URL` –±–µ—Ä–µ–º –∏–∑ [swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏](https://musicfun.it-incubator.app/api)

- `VITE_API_KEY` –±–µ—Ä–µ–º –∏–∑ [apihub](https://apihub.it-incubator.io/en) –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –Ω—É–∂–Ω–æ
  –∑–∞—Ä–µ–≥–∏—Å—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è

</Callout>

- `playlistsApi.types.ts`

```ts filename="playlistsApi.types.ts"
import type { CurrentUserReaction } from "@/common/enums"
import type { Images, Tag, User } from "@/common/types"

export type PlaylistsResponse = {
  data: PlaylistData[]
  meta: PlaylistMeta
}

export type PlaylistData = {
  id: string
  type: "playlists"
  attributes: PlaylistAttributes
}

export type PlaylistMeta = {
  page: number
  pageSize: number
  totalCount: number
  pagesCount: number
}

export type PlaylistAttributes = {
  title: string
  description: string
  addedAt: string
  updatedAt: string
  order: number
  dislikesCount: number
  likesCount: number
  tags: Tag[]
  images: Images
  user: User
  currentUserReaction: CurrentUserReaction
}

// Arguments
export type FetchPlaylistsArgs = {
  pageNumber?: number
  pageSize?: number
  search?: string
  sortBy?: "addedAt" | "likesCount"
  sortDirection?: "asc" | "desc"
  tagsIds?: string[]
  userId?: string
  trackId?: string
}
```

- `common/types/types.ts`

```ts filename="common/types/types.ts"
export type Tag = {
  id: string
  name: string
}

export type User = {
  id: string
  name: string
}

export type Images = {
  main: Cover[]
}

export type Cover = {
  type: "original" | "medium" | "thumbnail"
  width: number
  height: number
  fileSize: number
  url: string
}
```

- `common/enums/enums.ts`

```ts filename="common/enums/enums.ts"
export const CurrentUserReaction = {
  Like: 1,
  Dislike: -1,
  None: 0,
} as const

export type CurrentUserReaction = (typeof CurrentUserReaction)[keyof typeof CurrentUserReaction]
```

## Store

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ store

<Callout type={"info"} emoji={"üîó"}>
  - [Configure the Store](https://redux-toolkit.js.org/rtk-query/overview#configure-the-store)
</Callout>

–í —Ñ–∞–π–ª–µ `store.ts` –ø–æ–¥–∫–ª—é—á–∏—Ç–µ `playlistsApi`, –¥–æ–±–∞–≤—å—Ç–µ `middleware` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π `RTK Query`:
–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ, –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ pooling, –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ `setupListeners` –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å–ª—É—à–∞—Ç–µ–ª—è —Å–æ–±—ã—Ç–∏–π —Ñ–æ–∫—É—Å–∞ (`refetchOnFocus`)
–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è (`refetchOnReconnect`), —á—Ç–æ–±—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É
–∏–ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:

```ts filename="store.ts"
import { configureStore } from "@reduxjs/toolkit"
import { setupListeners } from "@reduxjs/toolkit/query"
import { playlistsApi } from "@/features/playlists/api/playlistsApi.ts"

export const store = configureStore({
  reducer: {
    [playlistsApi.reducerPath]: playlistsApi.reducer,
  },
  middleware: (getDefaultMiddleware) => getDefaultMiddleware().concat(playlistsApi.middleware),
})

setupListeners(store.dispatch)
```

### 2. Provider

–ß—Ç–æ–±—ã –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö –º–æ–∂–Ω–æ –±—ã–ª–æ –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∫ `store`, –Ω—É–∂–Ω–æ –æ–±–µ—Ä–Ω—É—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ [`Provider'–æ–º`](https://redux-toolkit.js.org/tutorials/quick-start#provide-the-redux-store-to-react)
—Å –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã–º –µ–º—É `store` –≤ —Ñ–∞–π–ª–µ `main.tsx`:

```tsx filename="main.tsx" {3,5}
createRoot(document.getElementById("root")!).render(
  <BrowserRouter>
    <Provider store={store}>
      <App />
    </Provider>
  </BrowserRouter>,
)
```

### 3. Redux devtools

- –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ [Redux devtools](https://chromewebstore.google.com/detail/redux-devtools/lmhkpmbekcpmknklioeibfkpmmfibljd)
- –û—Ç–∫—Ä–æ–π—Ç–µ –ø–∞–Ω–µ–ª—å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞ –∏ —É–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ `playlistsApi` –ø–æ–¥–∫–ª—é—á–µ–Ω:

![devtools](https://production-it-incubator.s3.eu-central-1.amazonaws.com/file-manager/Image/46e157ab-81ba-4e23-924d-6455a44b0200_redux-devtools.png)

## Query —Ö—É–∫

–í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ `PlaylistsPage.tsx` –≤—ã–∑–æ–≤–∏—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ö—É–∫ `useFetchPlaylistsQuery`. –ò –æ—Ç—Ä–∏—Å—É–π—Ç–µ
–ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

```tsx filename="PlaylistsPage.tsx" {2}
export const PlaylistsPage = () => {
  const { data } = useFetchPlaylistsQuery()

  return (
    <div>
      <h1>Playlists page</h1>
      <div>
        {data?.data.map((playlist) => {
          return (
            <div key={playlist.id}>
              <div>title: {playlist.attributes.title}</div>
            </div>
          )
        })}
      </div>
    </div>
  )
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–ª–µ–π–ª–∏—Å—Ç—ã –ø–æ–ª—É—á–µ–Ω—ã —Å —Å–µ—Ä–≤–µ—Ä–∞ –∏ –æ—Ç—Ä–∏—Å–æ–≤–∞–Ω—ã üöÄ

### –í–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ —Ö—É–∫–∞

–ù–∞ –∫–∞–∂–¥–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–æ–º–∏—Å–∞ –º—ã –ø–æ–ª—É—á–∞–µ–º –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π [–æ–±—ä–µ–∫—Ç —Å –¥–∞–Ω–Ω—ã–º–∏ –æ –∑–∞–ø—Ä–æ—Å–µ](https://redux-toolkit.js.org/rtk-query/usage/queries#frequently-used-query-hook-return-values):

- `data` - –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –≤–µ—Ä–Ω—É–ª –∑–∞–ø—Ä–æ—Å;
- `isLoading` - —Ñ–ª–∞–≥, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –∑–∞–ø—Ä–æ—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è;
- `isError` - —Ñ–ª–∞–≥, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –∑–∞–ø—Ä–æ—Å –∑–∞–≤–µ—Ä—à–∏–ª—Å—è —Å –æ—à–∏–±–∫–æ–π;
- `error` - –æ–±—ä–µ–∫—Ç –æ—à–∏–±–∫–∏;
- –¥—Ä.

### Query Hook Options

–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ö—É–∫ –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å [–ø–∞—Ä–∞–º–µ—Ç—Ä—ã](https://redux-toolkit.js.org/rtk-query/usage/queries#query-hook-options):

- `queryArg` - –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∑–∞–ø—Ä–æ—Å–∞;
- `queryOptions` - –æ–±—ä–µ–∫—Ç —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–º –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.

## –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–ª–µ–π–ª–∏—Å—Ç–æ–≤

–î–æ–±–∞–≤–∏–º –±–æ–ª—å—à–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–ª–µ–π–ª–∏—Å—Ç–∞—Ö –≤ —Ä–∞–∑–º–µ—Ç–∫–µ –∏ –Ω–∞—Å—Ç—Ä–æ–∏–º –±–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏

```tsx filename="PlaylistsPage.tsx"
export const PlaylistsPage = () => {
  const { data } = useFetchPlaylistsQuery()

  return (
    <div className={s.container}>
      <h1>Playlists page</h1>
      <div className={s.items}>
        {data?.data.map((playlist) => {
          return (
            <div className={s.item} key={playlist.id}>
              <div>title: {playlist.attributes.title}</div>
              <div>description: {playlist.attributes.description}</div>
              <div>userName: {playlist.attributes.user.name}</div>
            </div>
          )
        })}
      </div>
    </div>
  )
}
```

```css filename="PlaylistsPage.module.css"
.container {
  display: flex;
  flex-direction: column;
  gap: 30px;
}

.items {
  display: flex;
  gap: 30px;
  flex-wrap: wrap;
}

.item {
  width: 240px;
  padding: 16px;
  border: 1px solid #ddd;
  border-radius: 8px;
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –¢–µ–ø–µ—Ä—å —Å–ø–∏—Å–æ–∫ –ø–ª–µ–π–ª–∏—Å—Ç–æ–≤ –≤—ã–≥–ª—è–¥–∏—Ç –±–æ–ª–µ–µ –ø—Ä–∏–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω–æ üöÄ
